<odoo>




    <!-- Tree View -->
<record id="view_completion_certificate_output_tree" model="ir.ui.view">
    <field name="name">completion.certificate.output.tree</field>
    <field name="model">completion.certificate.output</field>
    <field name="arch" type="xml">
        <tree string="Certificate Outputs">
            <field name="name"/>
            <field name="description"/>
        </tree>
    </field>
</record>

<record id="view_completion_certificate_output_form" model="ir.ui.view">
    <field name="name">completion.certificate.output.form</field>
    <field name="model">completion.certificate.output</field>
    <field name="arch" type="xml">
        <form string="Certificate Output">
            <sheet>
                <group>
                    <field name="name"/>
                    <field name="description"/>
                </group>
            </sheet>
        </form>
    </field>
</record>








    <record id="view_completion_certificate_form" model="ir.ui.view">
        <field name="name">completion.certificate.form</field>
        <field name="model">completion.certificate</field>
        <field name="arch" type="xml">
            <form string="Completion Certificate">

                    <header>
                        <field name="state" widget="statusbar"
                               statusbar_visible="project_manager_preparation,project_manager_review,project_owner_approval,strategy_office_review,secretary_general_approval"
                                />

                        <button name="action_confirm_preparation"
                                string="Confirm Setup"
                                type="object"
                                class="btn-primary"
                                attrs="{'invisible': ['|', ('check_project_user', '=', False), ('state', '!=', 'project_manager_preparation')]}"
                                />

                        <button name="action_approve_project_owner"
                                string="Approve Owner"
                                type="object"
                                class="btn-primary"
                                attrs="{'invisible': ['|', ('check_project_owner', '=', False), ('state', '!=', 'project_owner_approval')]}"

                        />



                        <button name="action_review_project_manager"
                                string="PM Review"
                                type="object"
                                states="project_manager_review"
                                class="btn-primary"
                                groups="project.group_project_manager" />

                        <button name="action_review_strategy_office"
                                string="Strategy Office Review"
                                type="object"
                                states="strategy_office_review"
                                class="btn-primary"
                                groups="project_base.group_strategy_director"
                        />

                        <button name="action_approve_secretary_general"
                                string="SG Approval"
                                type="object"
                                states="secretary_general_approval"
                                class="btn-primary"
                                groups="hr_trahum.group_secretary_general"
                        />



                        <button name="re_draft"
                                string="Back to Start"
                                type="object"
                                class="btn-primary"
                                states="cancelled" />



                        <button name="action_go_back"
                            string="Go Back"
                            type="object"
                            class="btn-primary"
                            states="strategy_office_review"
                            groups="project_base.group_strategy_director"

                            />

                        <button name="action_cancel"
                                string="Cancel"
                                type="object"
                                class="btn-primary"
                                states="strategy_office_review"
                                groups="project_base.group_strategy_director"
                             />

                        <button name="action_go_back"
                            string="Go Back"
                            type="object"
                            class="btn-primary"
                            attrs="{'invisible': ['|', ('check_project_owner', '=', False), ('state', '!=', 'project_owner_approval')]}"


                             />

                        <button name="action_cancel"
                                string="Cancel"
                                type="object"
                                class="btn-primary"
                                attrs="{'invisible': ['|', ('check_project_owner', '=', False), ('state', '!=', 'project_owner_approval')]}"

 />

                        <button name="action_go_back"
                                string="Go Back"
                                type="object"
                                class="btn-primary"
                                states="project_manager_review"
                                groups="project.group_project_manager" />

                        <button name="action_cancel"
                                string="Cancel"
                                type="object"
                                class="btn-primary"
                                states="project_manager_review"
                                groups="project.group_project_manager" />

                        <button name="action_go_back"
                                string="Go Back"
                                type="object"
                                class="btn-primary"
                                states="secretary_general_approval"
                                groups="hr_trahum.group_secretary_general"
          />

                        <button name="action_cancel"
                                string="Cancel"
                                type="object"
                                class="btn-primary"
                                states="secretary_general_approval"
                                groups="hr_trahum.group_secretary_general"
          />




                    </header>




                <sheet>
                        <div class="oe_title">
                                    <label for="name" />
                                    <h1>
                                        <field name="name"  readonly="1"  />
                                    </h1>
                        </div>
                    <group>
                        <group>
                            <field name="project_id"  attrs="{'readonly': [('state', '!=', 'project_manager_preparation')]}"/>
                            <field name="phase_id4"  attrs="{'readonly': [('state', '!=', 'project_manager_preparation')]}"/>
                        </group>

                        <group>
                            <field name="date"  attrs="{'readonly': [('state', '!=', 'project_manager_preparation')]}"/>
                            <field name="attachment"  attrs="{'readonly': [('state', '!=', 'project_manager_preparation')]}"/>
                        </group>
                    </group>
                    <field name="check_project_owner" invisible="1"/>
                    <field name="check_project_user" invisible="1"/>
                        <notebook>
                            <page string="Description">
                                <field name="description" placeholder="Write a description here..." nolabel="1"  attrs="{'readonly': [('state', '!=', 'project_manager_preparation')]}"/>
                            </page>
                            <page string="Attachments">
                                <field name="attachment_ids" widget="many2many_binary"/>
                            </page>
                                <page string="Outputs">
                                    <field name="certificate_output_ids" mode="tree,form" context="{'default_certificate_id': active_id}">
                                        <tree editable="bottom">
                                            <field name="name"/>
                                            <field name="description"/>
                                        </tree>
                                    </field>
                                </page>
                                <page string="Executive Performance">
                                    <group>
                                        <separator string="Output Achievement Info" colspan="2"/>
                                                        <group col="2">
                                                            <field name="equivalent_output_weight"/>
                                                            <field name="achievement_percentage"
                                                                   widget="float"
                                                                   options="{'min': 0, 'max': 100, 'step': 1}"
                                                                   required="True"/>
                                                        </group>


                                        <separator string="Spending Details" colspan="2"/>
                                        <group col="2">
                                            <field name="planned_spending_until_delivery"/>
                                            <field name="actual_spending_until_delivery"/>
                                        </group>

                                        <separator string="Service Provider Evaluation" colspan="2"/>
                                        <field name="service_provider_performance" nolabel="1" placeholder="Describe the performance of the service provider and any applicable financial deductions..."/>
                                    </group>
                                </page>


                        </notebook>




                </sheet>
                <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                </div>

            </form>
        </field>
    </record>


        <record id="view_completion_certificate_tree" model="ir.ui.view">
        <field name="name">completion.certificate.tree</field>
        <field name="model">completion.certificate</field>
        <field name="arch" type="xml">
            <tree string="Completion Certificate" create="1" >
                <field name="name"/>
                <field name="project_id"/>
                <field name="phase_id4"/>
                <field name="date"/>
                <field name="state" />

            </tree>

        </field>
    </record>

    <record id="open_completion_certificate_form" model="ir.actions.act_window">
        <field name="name"> Completion  Certificate </field>
        <field name="res_model">completion.certificate</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_completion_certificate_tree"/>
                <field name="context">{'search_default_project': 1}</field>

    </record>


        <menuitem action="open_completion_certificate_form" id="menu_completion_certificate"  name="Completion  Certificate"  groups="hr_trahum.group_secretary_general,project.group_project_manager,project.group_project_manager,project_base.group_project_owner" parent="project.menu_main_pm" sequence="3"/>



</odoo>
