<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="account_move_form_inherit" model="ir.ui.view">
        <field name="name">saip.account.view.move.inherit.form</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//header" position="replace">
                <header>
                    <button name="accounting_department"
                            string="Send"
                            class="oe_highlight" type="object"
                            groups="odex25_account_saip.group_assistant_accountant"/>
<!--                            attrs="{'invisible': ['|',('move_type', 'in', ('out_invoice')),('state', 'not in', ['budget_management','draft'])]}"/>-->
                    <!--                            attrs="{'invisible': [('move_type', 'not in', ('in_invoice')),('state', 'not in', ['draft','accounting_department','posted','cancel'])]}"/>-->

                    <button name="action_post" string="Post"
                            class="oe_highlight"
                            type="object"
                            groups="odex25_account_saip.group_post_account_department"
                            states="accounting_department"
                            attrs="{'invisible': ['|', '|', ('state', 'not in', ['accounting_department']), ('auto_post', '=', True), ('move_type', 'not in', ('entry','out_invoice','out_refund','in_refund'))]}"/>


                    <button name="action_invoice_sent" type="object"
                            string="Send &amp; Print"
                            attrs="{'invisible':['|', '|', ('state', '!=', 'posted'), ('is_move_sent', '=', True), ('move_type', 'not in', ('out_invoice', 'out_refund','odex25_account_saip'))]}"
                            class="oe_highlight"/>
                    <button name="action_invoice_sent" type="object"
                            string="Send &amp; Print"
                            attrs="{'invisible':['|', '|', ('state', '!=', 'posted'), ('is_move_sent', '=', False), ('move_type', 'not in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund'))]}"/>
                    <!-- Register Payment (only invoices / receipts) -->
                    <button name="action_register_payment"
                            id="account_invoice_payment_btn" type="object"
                            invisible="1"
                            class="oe_highlight"
                            attrs="{'invisible': ['|', '|', ('state', '!=', 'posted'), ('payment_state', 'not in', ('not_paid', 'partial')), ('move_type', 'not in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt'))]}"
                            context="{'dont_redirect_to_payments': True}"
                            string="Register Payment"
                            groups="account.group_account_invoice"/>
                    <!-- Preview (only customer invoices) -->
                    <button name="preview_invoice" type="object"
                            string="Preview"
                            attrs="{'invisible': [('move_type', 'not in', ('out_invoice', 'out_refund'))]}"/>
                    <!-- Reverse -->
                    <button name="%(account.action_view_account_move_reversal)d"
                            string="Reverse Entry" type="action"
                            groups="account.group_account_invoice" invisible="1"/>
<!--                            attrs="{'invisible': ['|', ('move_type', '!=', 'entry'), '|', ('state', '!=', 'posted'), ('payment_state', '=', 'reversed')]}"/>-->
                    <button name="action_reverse" string='Add Credit Note'
                            type='object'
                            invisible="1"
                            groups="account.group_account_invoice"
                            attrs="{'invisible': ['|', ('move_type', 'not in', ('out_invoice', 'in_invoice')), ('state', '!=', 'posted')]}"/>
                    <!-- Cancel -->
                    <button name="button_cancel" string="Cancel Entry"
                            type="object" invisible="1"/>

                    <button name="button_draft" string="Reset to Draft"
                            type="object"
                            groups="account.group_account_invoice"
                            invisible="1"
                    />
<!--                            attrs="{'invisible' : [('show_reset_to_draft_button', '=', False)]}"-->

                    <field name="state_in" widget="statusbar"
                           attrs="{'invisible': [('move_type', 'not in', ('in_invoice'))]}"
                           statusbar_visible="draft,accounting_department,posted"/>
                    <field name="state_in_receipt" widget="statusbar"
                           attrs="{'invisible': [('move_type', 'not in', ('in_receipt'))]}"
                           statusbar_visible="draft,budget_management,accounting_department,posted"/>
                    <field name="state" widget="statusbar"
                           attrs="{'invisible': [('move_type', 'not in', ('entry','out_invoice','out_refund','in_refund'))]}"
                           statusbar_visible="draft,posted,cancel"/>
                </header>
            </xpath>

            <field name="invoice_date" position="replace">
                <field name="invoice_date" nolabel="1"
                       options="{'datepicker': {'warn_future': true}}"
                       attrs="{'readonly': [('state', '=', 'posted')] ,'invisible': [('move_type', 'not in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt'))]}"/>

            </field>
            <field name="partner_id" position="replace">
                <field name="partner_id" widget="res_partner_many2one" nolabel="1"
                       context="{
                             'res_partner_search_mode': (context.get('default_move_type', 'entry') in ('out_invoice', 'out_refund', 'out_receipt') and 'customer') or (context.get('default_move_type', 'entry') in ('in_invoice', 'in_refund', 'in_receipt') and 'supplier') or False,
                             'show_address': 1, 'default_is_company': True, 'show_vat': True}"
                       options='{"always_reload": True, "no_quick_create": True}'
                       attrs="{'invisible': [('move_type', 'not in',('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt'))],'readonly':[('state','in',['posted','accounting_department'])]}"/>

            </field>
            <xpath expr="//page[@id='aml_tab']" position="attributes">
                <attribute name="groups">account.group_account_readonly,account.group_account_invoice</attribute>
            </xpath>
             <xpath expr="//label[@for='journal_id']" position="attributes">
                <attribute name="groups">account.group_account_readonly,account.group_account_invoice</attribute>
            </xpath>
            <xpath expr="//div[@name='journal_div']" position="attributes">
                <attribute name="groups">account.group_account_readonly,account.group_account_invoice</attribute>
            </xpath>
             <xpath expr="//field[@name='invoice_line_ids']//tree//field[@name='account_id']" position="attributes">
               <attribute name="groups">account.group_account_readonly,account.group_account_invoice</attribute>
            </xpath>

        </field>
    </record>

     <record id="account.menu_action_move_in_refund_type" model="ir.ui.menu">
            <field name="active" eval="False"/>

     </record> <record id="account.menu_action_move_out_refund_type" model="ir.ui.menu">
            <field name="active" eval="False"/>
     </record>

     <record id="account.menu_action_account_payments_payable" model="ir.ui.menu">
            <field name="active" eval="False"/>
     </record>

    <record id="account.res_partner_action_supplier" model="ir.actions.act_window">
            <field name="domain">[('user_ids', '=', False), ('is_company', '=', True)]</field>
     </record>
</odoo>