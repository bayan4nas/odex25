<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <record id="paperformat_e_invoice" model="report.paperformat">
            <field name="name">A4 E-Invoice Format</field>
            <field name="default" eval="False"/>
            <field name="format">A4</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">25</field>
            <field name="margin_bottom">25</field>
            <field name="margin_left">20</field>
            <field name="margin_right">20</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">15</field>
        </record>

<template id="report_e_invoice_header">
    <div class="header" style="height: 40mm; margin-bottom: 25mm; border-top: 0.5mm solid #2C3E50; padding: 5mm 0;">
        <div style="display: flex; align-items: center; justify-content: space-between; height: 100%; width: 100%;">
            <!-- Left Logo -->
            <img src="/report_e_invoice/static/src/img/logo-tarahum.jpg"
                 style="height: 15mm; margin-right: auto; object-fit: contain;"
                 alt="اللجنة الوطنية لعاية السجناء"/>

            <!-- Center QR Code -->
            <!-- <t t-if="o.qr_string">
                <img t-att-src="'data:image/png;base64,' + o.qr_string"
                     style="height: 20mm; width: 20mm; object-fit: contain; margin: 0 auto;"
                     alt="QR Code"/>
            </t> -->

            <!-- Right Logo -->
            <img src="/report_e_invoice/static/src/img/vision_2030_header.jpg"
                 style="height: 15mm; margin-left: auto; object-fit: contain;"
                 alt="VISION 2030"/>
        </div>
    </div>
</template>







        <template id="report_e_invoice_footer">
    <div class="footer" style="border-top: 2px solid #2C3E50; padding: 15px 0; font-size: 12px;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <!-- Badges (Moved to Left) -->
            <div style="display: flex; gap: 8px; justify-content: flex-start;">
                <img src="/report_e_invoice/static/src/img/Customer_Happiness.png" style="height: 20px;"/>
                <img src="/report_e_invoice/static/src/img/scxatm.jpg" style="height: 20px;"/>
                <img src="/report_e_invoice/static/src/img/iso_efqm.png" style="height: 20px;"/>
                <img src="/report_e_invoice/static/src/img/qr_code.png" style="height: 20px;"/>
                <img src="/report_e_invoice/static/src/img/greatplace_towork.png" style="height: 20px;"/>
            </div>

            <!-- Contact Info (Moved to Right) -->
            <div style="text-align: right; direction: rtl;">
                <div>ص.ب 25003 | الرياض 11466 | الهاتف المجاني 9200 15615 - هاتف 011 2197767 | فاكس 011 2171611</div>
                <div style="direction: ltr; margin-top: 5px;">
                    PO Box 25003 | Riyadh 11466 | Tol Free 9200 15615 - Tel 011 2197767 | Fax 011 2171611
                </div>
                <div style="display: flex; gap: 10px; align-items: center; margin-top: 5px; direction: ltr;">
                    <img src="/report_e_invoice/static/src/img/envelope.png" style="height: 16px;"/>
                    <span>Info@trahum.sa |</span>
                    <img src="/report_e_invoice/static/src/img/linkedin.png" style="height: 16px;"/>
                    <span>@Trahum_sa |</span>
                    <img src="/report_e_invoice/static/src/img/global.png" style="height: 16px;"/>
                    <span>www.trahum.sa</span>
                </div>
            </div>
        </div>
    </div>
</template>

        <template id="report_e_invoice">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="report_e_invoice.report_e_invoice_header" t-lang="lang"/>
                    <t t-set="o" t-value="o.with_context(lang=lang)"/>
                    <div class="article" data-oe-model="account.move" t-att-data-oe-id="o.id">
                        <style>
                            @font-face {
                                font-family: 'DINNextLTArabic';
                                src: url('/report_e_invoice/static/src/fonts/DINNextLTArabic-Regular_0.ttf') format('truetype');
                                font-weight: normal;
                            }
                            body {
                                font-family: 'DINNextLTArabic', sans-serif;
                                font-size: 12px;
                                line-height: 1.6;
                                color: #333;
                                direction: rtl;
                            }
                            .invoice-title {
                                color: #1A5276;
                                font-size: 22px;
                                font-weight: bold;
                                text-align: center;
                                margin: 20px 0;
                            }
                            .section-header {
                                background: #F8F9FA;
                                border: 1px solid #E5E7E9;
                                border-radius: 6px;
                                padding: 10px;
                                margin: 15px 0;
                                font-weight: bold;
                            }
                            .info-table {
                                width: 100%;
                                margin: 20px 0;
                                border-collapse: collapse;
                            }
                            .info-table td {
                                padding: 8px;
                                vertical-align: top;
                            }
                            .line-items-table {
                                width: 100%;
                                border-collapse: collapse;
                                margin: 20px 0;
                            }
                            .line-items-table th {
                                background: #1A5276;
                                color: white;
                                padding: 10px;
                                border: 1px solid #1A5276;
                                font-size: 11px;
                            }
                            .line-items-table td {
                                border: 1px solid #E5E7E9;
                                padding: 8px;
                                font-size: 11px;
                            }
                            .total-section {
                                float: left;
                                width: 35%;
                                margin-top: 20px;
                            }
                            .total-table {
                                width: 100%;
                                border-collapse: collapse;
                            }
                            .total-table td {
                                padding: 10px;
                                border: 1px solid #E5E7E9;
                            }
                            .total-row {
                                background: #1A5276;
                                color: white;
                                font-weight: bold;
                            }
                        </style>
                        <div class="page">
                            <h1 class="invoice-title" style="margin: 50px 0 25px 0;padding-top: 30px;">فاتورة ضريبية - Tax Invoice</h1>

                            <table class="info-table">
                                <tr>
                                    <td style="width: 30%;">
                                        <div style="margin-bottom: 10px;">
                                            <strong>تاريخ الاصدار</strong><br/>
                                            <span t-field="o.invoice_date"/>
                                        </div>
                                        <div>
                                            <strong>تاريخ التوريد</strong><br/>
                                            <t t-if="o.picking_delivery_date">
                                                <span t-field="o.picking_delivery_date"/>
                                            </t>
                                        </div>
                                    </td>
                                    <td style="width: 40%; text-align: center; font-size: 16px; font-weight: bold;">
                                        <span t-field="o.name"/>
                                    </td>
                                    <td style="width: 30%; text-align: left;">
                                        <strong>رقم الفاتورة</strong><br/>
                                        <span t-field="o.name"/>
                                    </td>
                                </tr>
                            </table>

                            <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                                <div style="width: 50%;">
                                    <div class="section-header">من - From</div>
                                    <div style="padding: 10px;">
                                        <div style="font-weight: bold;"><span t-field="o.company_id.partner_id.name"/></div>
                                        <div><span t-field="o.company_id.partner_id.street"/></div>
                                        <div>الرقم الضريبي: <span t-field="o.company_id.partner_id.vat"/></div>
                                    </div>
                                </div>
                                <div style="width: 50%;">
                                    <div class="section-header">الى - To</div>
                                    <div style="padding: 10px;">
                                        <div style="font-weight: bold;"><span t-field="o.partner_id.name"/></div>
                                        <div><span t-field="o.partner_id.street"/></div>
                                        <div>الرقم الضريبي: <span t-field="o.partner_id.vat"/></div>
                                    </div>
                                </div>
                            </div>

                            <table class="line-items-table">
                                <thead>
                                    <tr>
                                        <th>الوصف</th>
                                        <th>السعر</th>
                                        <th>الكمية</th>
                                        <th>الخصم</th>
                                        <th>المبلغ قبل الضريبة</th>
                                        <th>نسبة الضريبة</th>
                                        <th>قيمة الضريبة</th>
                                        <th>الإجمالي</th>
                                    </tr>
                                    <tr>
                                        <th>Description</th>
                                        <th>Price</th>
                                        <th>Qty</th>
                                        <th>Discount</th>
                                        <th>Taxable</th>
                                        <th>VAT %</th>
                                        <th>VAT</th>
                                        <th>Total</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="o.invoice_line_ids" t-as="line">
                                        <tr>
                                            <td><span t-field="line.name"/></td>
                                            <td><span t-field="line.price_unit"/></td>
                                            <td><span t-field="line.quantity"/></td>
                                            <td><span t-field="line.discount"/>%</td>
                                            <td><span t-field="line.price_subtotal"/></td>
                                            <td><span t-esc="', '.join(map(lambda x: (x.description or x.name), line.tax_ids))"/></td>
                                            <td><span t-esc="line.price_total - line.price_subtotal"/></td>
                                            <td><span t-field="line.price_total"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>

                            <div class="total-section">
                                <table class="total-table">
                                    <tr>
                                        <td>الإجمالي الفرعي</td>
                                        <td style="text-align: left;"><span t-field="o.amount_untaxed"/></td>
                                    </tr>
                                    <tr>
                                        <td>الضريبة</td>
                                        <td style="text-align: left;"><span t-field="o.amount_tax"/></td>
                                    </tr>
                                    <tr class="total-row">
                                        <td>المبلغ الإجمالي</td>
                                        <td style="text-align: left;"><strong><span t-field="o.amount_total"/></strong></td>
                                    </tr>
                                </table>
                            </div>
                            <div style="clear: both;"></div>
                        </div>
                    </div>
                    <t t-call="report_e_invoice.report_e_invoice_footer" t-lang="lang"/>
                </t>
            </t>
        </template>

        <record id="account_e_invoices" model="ir.actions.report">
            <field name="name">E-Invoice with Header</field>
            <field name="model">account.move</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">report_e_invoice.report_e_invoice</field>
            <field name="binding_model_id" ref="account.model_account_move"/>
            <field name="binding_type">report</field>
            <field name="paperformat_id" ref="report_e_invoice.paperformat_e_invoice"/>
        </record>
    </data>
</odoo>